<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{HTDShop/layout}">

<head>
    <title>HTD Shop - Search</title>
    <th:block layout:fragment="additionalCss">
        <link rel="stylesheet" th:href="@{/resources/Content/fontawesome-free/css/all.min.css}">
    </th:block>
    <style>

    </style>
</head>

<body>
    <div layout:fragment="content">
        <div class="breadcrumb-area pt-10 pb-10"
            style="background-image: linear-gradient(141deg, #9fb8ad 0%, #fff 51%, #9fb8ad 75%);">
            <div class="container">
                <div class="breadcrumb-content text-center">
                    <ul>
                        <li><a th:href="@{/}">home</a></li>
                        <li id="searchLabel">Search: "[[${param.search}]]"</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="shop-page-wrapper shop-page-padding ptb-100">
            <div class="container-fluid">
                <div class="row" id="scrollHere">
                    <div class="col-lg-3">
                        <div class="shop-sidebar mr-50">
                            <div class="sidebar-widget mb-50">
                                <h3 class="sidebar-title">Search Products</h3>
                                <div class="sidebar-search">
                                    <form id="searchKeyword">
                                        <input placeholder="Search Products..." type="text" th:value="${param.keyword}"
                                            name="keyword" id="keyword">
                                        <button type="submit"><i class="ti-search"></i></button>
                                    </form>
                                </div>
                            </div>
                            <div class="sidebar-widget mb-45">
                                <h3 class="sidebar-title">Categories</h3>
                                <div class="sidebar-categories">
                                    <select class="select" name="category" id="category">
                                        <option value="0" th:selected="${T(Integer).parseInt(param.category) == 0}">All
                                        </option>
                                        <option th:each="cate : ${session.categories}" th:value="${cate.id}"
                                            th:text="${cate.name}"
                                            th:selected="${T(Integer).parseInt(param.category) == cate.id}">
                                            All Categories
                                        </option>
                                    </select>
                                </div>
                            </div>
                            <div class="sidebar-widget mb-40">
                                <h3 class="sidebar-title">Filter by Price</h3>
                                <div class="d-flex">
                                    <form id="searchPrice" class="d-flex">
                                        <input type="number" placeholder="From..."
                                            th:value="${param.from!=null?param.from:'0'}" name="from" size="5" required
                                            min=0 max=10000 id="from">
                                        <input type="number" placeholder="To..."
                                            th:value="${param.to!=null?param.to:'10000'}" name="to" size="5" required
                                            min=10 max=10000 id="to">
                                        <button type="submit">Filter</button>
                                    </form>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="col-lg-9" id="result">

                    </div>
                </div>
            </div>
        </div>


        <!-- modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-hidden="true">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span class="pe-7s-close" aria-hidden="true"></span>
            </button>
            <div class="modal-dialog modal-quickview-width" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="qwick-view-left">
                            <div class="quick-view-learg-img">
                                <div class="quick-view-tab-content tab-content">
                                    <div class="tab-pane active show fade" id="modal1" role="tabpanel">
                                        <img src="assets/img/quick-view/l1.jpg" alt="">
                                    </div>
                                    <div class="tab-pane fade" id="modal2" role="tabpanel">
                                        <img src="assets/img/quick-view/l2.jpg" alt="">
                                    </div>
                                    <div class="tab-pane fade" id="modal3" role="tabpanel">
                                        <img src="assets/img/quick-view/l3.jpg" alt="">
                                    </div>
                                </div>
                            </div>
                            <div class="quick-view-list nav" role="tablist">
                                <a class="active" href="#modal1" data-toggle="tab" role="tab">
                                    <img src="assets/img/quick-view/s1.jpg" alt="">
                                </a>
                                <a href="#modal2" data-toggle="tab" role="tab">
                                    <img src="assets/img/quick-view/s2.jpg" alt="">
                                </a>
                                <a href="#modal3" data-toggle="tab" role="tab">
                                    <img src="assets/img/quick-view/s3.jpg" alt="">
                                </a>
                            </div>
                        </div>
                        <div class="qwick-view-right">
                            <div class="qwick-view-content">
                                <h3>Handcrafted Supper Mug</h3>
                                <div class="price">
                                    <span class="new">$90.00</span>
                                    <span class="old">$120.00 </span>
                                </div>
                                <div class="rating-number">
                                    <div class="quick-view-rating">
                                        <i class="pe-7s-star"></i>
                                        <i class="pe-7s-star"></i>
                                        <i class="pe-7s-star"></i>
                                        <i class="pe-7s-star"></i>
                                        <i class="pe-7s-star"></i>
                                    </div>
                                    <div class="quick-view-number">
                                        <span>2 Ratting (S)</span>
                                    </div>
                                </div>
                                <p>Lorem ipsum dolor sit amet, consectetur adip elit, sed do tempor incididun ut labore
                                    et dolore magna aliqua. Ut enim ad mi , quis nostrud veniam exercitation .</p>
                                <div class="quick-view-select">
                                    <div class="select-option-part">
                                        <label>Size*</label>
                                        <select class="select">
                                            <option value="">- Please Select -</option>
                                            <option value="">900</option>
                                            <option value="">700</option>
                                        </select>
                                    </div>
                                    <div class="select-option-part">
                                        <label>Color*</label>
                                        <select class="select">
                                            <option value="">- Please Select -</option>
                                            <option value="">orange</option>
                                            <option value="">pink</option>
                                            <option value="">yellow</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="quickview-plus-minus">
                                    <div class="cart-plus-minus">
                                        <input type="text" value="02" name="qtybutton" class="cart-plus-minus-box">
                                    </div>
                                    <div class="quickview-btn-cart">
                                        <a class="btn-hover-black" href="#">add to cart</a>
                                    </div>
                                    <div class="quickview-btn-wishlist">
                                        <a class="btn-hover" href="#"><i class="pe-7s-like"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script layout:fragment="script" th:inline="javascript">
        /*<![CDATA[*/
        doSearch();

        $("#category").on("change", function () { doSearch() });

        $("#searchKeyword").on("submit", function (e) {
            e.preventDefault();
            doSearch();
        });

        $("#searchPrice").on("submit", function (e) {
            e.preventDefault();
            if (+$("#from").val() > +$("#to").val()) {
                $("#from").val(0);
            }
            doSearch();
        });

        function doSearch(page) {
            if (+$("#from").val() > +$("#to").val()) {
                $("#from").val(0);
            }
            var searchUrl = /*[[@{/search/result}]]*/'';
            var kParam = $("#keyword").val();
            var cParam = $("#category").val();
            var styleParam = /*[[${param.style!=null?param.style:''}]]*/"";
            var pageParam = /*[[${param.page!=null?param.page:1}]]*/1;
            var fromParam = $("#from").val();
            var toParam = $("#to").val();
            var sortParam = "default";
            if ($("#sort").length) {
                sortParam = $("#sort").val();
            }
            if (page != null) {
                pageParam = page;
            }
            searchUrl += "?c=" + cParam + "&k=" + kParam + "&style=" + styleParam + "&page=" + pageParam + "&from=" + fromParam + "&to=" + toParam + "&sort=" + sortParam;

            $.post(searchUrl, function (data) {
                var myEvent = function () {
                    $("#result").fadeOut();
                };
                $.when(myEvent()).done(function () {
                    $("#result").hide().html(data).fadeIn();
                });
                $("#searchLabel").html("Search: \"" + kParam + "\"");
                //$("#result").fadeOut('fast').html(data).fadeIn();
                //$(data).hide().appendTo('#result').fadeIn();
                //$("#result").html(data);
            });

            $([document.documentElement, document.body]).animate({
                scrollTop: $("#scrollHere").offset().top
            }, 500);
        }

        /*]]>*/
    </script>
</body>

</html>